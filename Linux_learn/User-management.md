# 用户与用户组管理

## 用户管理

### 基本概念

用户标识符：UID GID
UID GID 和用户名对应关系：

>/etc/passwd   /etc/group


用户密码存储位置：

>/etc/shadow


UID范围：
>0      系统管理员
1-999  系统账号
1000-  其余一般账号


需要注意的安全性问题：
1.因为/etc/passwd   /etc/group    /etc/shadow 都是敏感文件，需要将权限设置为只有root可读写  -rw-r--r--
2.防止其他人窃取用户或者暴力破解密码，建议经常更换密码，修改/etc/shadow 的下面的部分字段

>第四个字段：修改密码需要等待的天数，建议修改，防止密码被一些人一改再改
第五个字段：修改密码后重新修改的天数，必须在这个天数内修改密码，否则密码会过期，建议修改
第六个字段：密码需要修改前几天给用户警告提示，会提醒用户再过n天用户密码就过期了
第七个字段：密码过期后，给用户留的修改密码的宽限时间
第八个字段：在这个天数后，这个用户将无法使用，不管密码是不也是过期，这个天数是1970年以来的天数

### 用户添加删除

添加用户常见操作
>创建user1用户并强制创建家目录
useradd user1 -m
最主要的就是更新相关用户配置文件

设置用户密码
>passwd user1
注意：使用root给其他用户设置密码不需要输入当前密码，而且密码的复杂度没有限制，但是用户给自己修改自己的密码，就需要输入当前的密码，而且密码不能太简单

>passwd -S user1
user1 P 07/20/2021 0 99999 7 -1
查看当前用户P代表密码可用、密码修改时间、修改密码需要等待的天数、密码有效期、警告日期、密码不会失效
建议使用chage [参数] user 命令，可以用chage命令修改这些字段，chage -h
usermod  微调用户数据

>userdel -r user1
彻底删除user1用户及所属文件

其他相关命令
>id  显示用户UID/GID等信息
chsh -s /bin/bash user1 指定用户登录shell




## 用户组管理

>/etc/group
plugdev:x:46:yc   # 如果存在plugdev用户，那么
plugdev用户组包含plugdev和yc两个用户


一个用户可以加入多个用户组，同时拥有这些用户组的权限

概念：
初始 用户组：账号一登录就会有这个用户组的权限，在/etc/passwd的第四个字段
有效用户组：groups   命令第一个显示的用户组，用户touch 一个文件，这个文件所属的用户组就是用有效用户组初始化的

相关命令：
>groupadd   创建用户组
groupdel    删除用户组， 没有没有人加入这个用户组，可以删除

查看用户管理相关文件字段代表含义
>man 5 passwd
man 5 group
man 5 shadow
groups   #显示当前用户加入的用户组
newgrp   #修改用户有效用户组 

建议使用去权限较低的用户去启动系统服务，所以有些系统服务系统会建立一个账号去运行，比如ntp服务

>sudo 命令，使用其他用户权限执行命令，默认是root权限，
/etc/sudoers 里面的用户才能执行sudo 命令
使用visudo 去编辑这个文件，系统才回去检测这个文件的语法是否正确
也可以设置不需要密码使用sudo命令
